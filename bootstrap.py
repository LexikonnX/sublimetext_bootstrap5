import sublime_plugin
import sublime

bootstrap_classes = ["accordion-body", "accordion-button", "accordion-collapse", "accordion-flush", "accordion-header", "accordion-item", "collapsed", "alert-danger", "alert-dark", "alert-dismissible", "alert-heading", "alert-info", "alert-light", "alert-link", "alert-primary", "alert-secondary", "alert-success", "alert-warning", "fade", "badge", "badge-danger", "badge-dark", "badge-info", "badge-light", "badge-pill", "badge-primary", "badge-secondary", "badge-success", "badge-warning", "border", "border-*-0", "border-1", "border-danger", "border-dark", "border-info", "border-light", "border-primary", "border-secondary", "border-success", "border-warning", "border-white", "rounded", "rounded-*", "rounded-0", "rounded-1", "rounded-2", "rounded-3", "rounded-bottom", "rounded-circle", "rounded-end", "rounded-pill", "rounded-start", "rounded-top", "breadcrumb", "breadcrumb-item", "btn-group", "btn-group", "btn-group-lg", "btn-group-sm", "btn-group-vertical", "btn-toolbar", "active", "btn-block", "btn-lg", "btn-sm", "checkbox", "disabled", "radio", "btn", "btn-close", "btn-close-white", "btn-danger", "btn-dark", "btn-info", "btn-light", "btn-link", "btn-outline-danger", "btn-outline-dark", "btn-outline-info", "btn-outline-light", "btn-outline-primary", "btn-outline-secondary", "btn-outline-success", "btn-outline-warning", "btn-primary", "btn-secondary", "btn-success", "btn-warning", "card", "card", "card-body", "card-columns", "card-deck", "card-footer", "card-group", "card-header", "card-header-pills", "card-header-tabs", "card-img-bottom", "card-img-overlay", "card-img-top", "card-link", "card-subtitle", "card-text", "card-title", "h*.card-header", "list-group", "middle", "stretched-link", "carousel", "carousel-caption", "carousel-control-next", "carousel-control-next-icon", "carousel-control-prev", "carousel-control-prev-icon", "carousel-dark", "carousel-fade", "carousel-indicators", "carousel-inner", "carousel-item", "accordion", "collapse", "bg-body", "bg-danger", "bg-dark", "bg-gradient", "bg-info", "bg-light", "bg-primary", "bg-secondary", "bg-success", "bg-transparent", "bg-warning", "bg-white", "link-danger", "link-dark", "link-info", "link-light", "link-primary", "link-secondary", "link-success", "link-warning", "text-danger", "text-dark", "text-info", "text-light", "text-primary", "text-secondary", "text-success", "text-warning", "text-white", "custom-checkbox", "custom-file", "custom-radio", "custom-range", "custom-select", "custom-switch", "d-*-block", "d-*-flex", "d-*-inline", "d-*-inline-block", "d-*-inline-flex", "d-*-none", "d-*-table", "d-*-table-cell", "d-grid", "d-lg-grid", "d-lg-table-row", "d-md-grid", "d-md-table-row", "d-print-...", "d-print-flex", "d-print-grid", "d-print-inline-flex", "d-print-table", "d-print-table-cell", "d-print-table-row", "d-sm-grid", "d-sm-table-row", "d-table-row", "d-xl-grid", "d-xl-table-row", "d-xxl-block", "d-xxl-flex", "d-xxl-grid", "d-xxl-inline", "d-xxl-inline-block", "d-xxl-inline-flex", "d-xxl-none", "d-xxl-table", "d-xxl-table-cell", "d-xxl-table-row", "dropdown", "dropdown", "dropdown-divider", "dropdown-header", "dropdown-item", "dropdown-item", "dropdown-item-text", "dropdown-menu", "dropdown-menu-dark", "dropdown-menu-end", "dropdown-menu-lg-end", "dropdown-menu-lg-start", "dropdown-menu-md-end", "dropdown-menu-md-start", "dropdown-menu-right", "dropdown-menu-sm-end", "dropdown-menu-sm-start", "dropdown-menu-start", "dropdown-menu-xl-end", "dropdown-menu-xl-start", "dropdown-toggle", "dropdown-toggle-split", "dropleft", "dropright", "dropup", "dropup", "figure", "figure-caption", "figure-img", "align-content-*-around", "align-content-*-center", "align-content-*-end", "align-content-*-start", "align-content-*-stretch", "align-items-*-baseline", "align-items-*-center", "align-items-*-end", "align-items-*-start", "align-items-*-stretch", "align-self-*-baseline", "align-self-*-center", "align-self-*-end", "align-self-*-start", "align-self-*-stretch", "flex-*-column", "flex-*-column-reverse", "flex-*-grow-0", "flex-*-grow-1", "flex-*-nowrap", "flex-*-row", "flex-*-row-reverse", "flex-*-shrink-0", "flex-*-shrink-1", "flex-*-wrap", "flex-*-wrap-reverse", "flex-fill", "flex-lg-fill", "flex-md-fill", "flex-sm-fill", "flex-xl-fill", "flex-xxl-column", "flex-xxl-column-reverse", "flex-xxl-fill", "flex-xxl-grow-0", "flex-xxl-grow-1", "flex-xxl-nowrap", "flex-xxl-row", "flex-xxl-row-reverse", "flex-xxl-shrink-0", "flex-xxl-shrink-1", "flex-xxl-wrap", "flex-xxl-wrap-reverse", "justify-content-*-around", "justify-content-*-between", "justify-content-*-center", "justify-content-*-end", "justify-content-*-start", "justify-content-around", "justify-content-between", "justify-content-center", "justify-content-end", "justify-content-evenly", "justify-content-lg-around", "justify-content-lg-between", "justify-content-lg-center", "justify-content-lg-end", "justify-content-lg-evenly", "justify-content-lg-start", "justify-content-md-around", "justify-content-md-between", "justify-content-md-center", "justify-content-md-end", "justify-content-md-evenly", "justify-content-md-start", "justify-content-sm-around", "justify-content-sm-between", "justify-content-sm-center", "justify-content-sm-end", "justify-content-sm-evenly", "justify-content-sm-start", "justify-content-start", "justify-content-xl-around", "justify-content-xl-between", "justify-content-xl-center", "justify-content-xl-end", "justify-content-xl-evenly", "justify-content-xl-start", "justify-content-xxl-around", "justify-content-xxl-between", "justify-content-xxl-center", "justify-content-xxl-end", "justify-content-xxl-evenly", "justify-content-xxl-start", "order-*-#", "order-0", "order-1", "order-first", "order-last", "order-lg-0", "order-lg-first", "order-lg-last", "order-md-0", "order-md-first", "order-md-last", "order-sm-0", "order-sm-first", "order-sm-last", "order-xl-0", "order-xl-first", "order-xl-last", "order-xxl-0", "order-xxl-first", "order-xxl-last", "checkbox", "dropdown", "input-group", "input-group-append", "input-group-lg", "input-group-prepend", "input-group-sm", "radio", "segmented", "form", "col-form-label", "col-form-label-lg", "col-form-label-sm", "disabled", "form-check", "form-check-inline", "form-check-input", "form-check-label", "form-control", "form-control-color", "form-control-file", "form-control-lg", "form-control-plaintext", "form-control-range", "form-control-sm", "form-floating", "form-group", "form-inline", "form-label", "form-select", "form-select-lg", "form-select-sm", "form-switch", "form-text", "input-group-text", "is-invalid", "is-valid", "readonly", "valid-feedback", "valid-tooltip", "col", "col-*", "col-#", "col-1", "col-10", "col-11", "col-12", "col-2", "col-3", "col-4", "col-5", "col-6", "col-7", "col-8", "col-9", "col-auto", "col-lg-#", "col-lg-1", "col-md-#", "col-md-1", "col-sm-#", "col-sm-1", "col-xl-#", "col-xl-1", "col-xxl-1", "container", "container-fluid", "container-sm", "contanier-lg", "contanier-md", "contanier-xl", "contanier-xxl", "g-0", "g-lg-0", "g-md-0", "g-sm-0", "g-xl-0", "g-xxl-0", "gap-0", "gap-lg-0", "gap-md-0", "gap-sm-0", "gap-xl-0", "gap-xxl-0", "gx-0", "gx-0", "gx-lg-0", "gx-lg-0", "gx-md-0", "gx-md-0", "gx-sm-0", "gx-sm-0", "gx-xl-0", "gx-xl-0", "gx-xxl-0", "gy-xxl-0", "nested", "no-gutters", "offset-*-#", "offset-0", "offset-lg-0", "offset-md-0", "offset-xxl-0", "order-#", "row", "row-cols-1", "row-cols-auto", "row-cols-lg-1", "row-cols-lg-auto", "row-cols-md-1", "row-cols-md-auto", "row-cols-sm-1", "row-cols-sm-auto", "row-cols-xl-1", "row-cols-xl-auto", "row-cols-xxl-1", "row-cols-xxl-auto", "img-fluid", "img-thumbnail", "jumbotron", "jumbotron-fluid", "list-group", "list-group", "list-group", "list-group-item", "list-group-item", "list-group-item-action", "list-group-item-danger", "list-group-item-dark", "list-group-item-info", "list-group-item-light", "list-group-item-primary", "list-group-item-secondary", "list-group-item-success", "list-group-item-warning", "list-group-flush", "list-group-horizontal", "list-group-horizontal-lg", "list-group-horizontal-md", "list-group-horizontal-sm", "list-group-horizontal-xl", "list-group-horizontal-xxl", "list-group-item", "d-flex", "d-flex", "d-flex", "media", "nested", "right", "close", "embed-responsive", "initialism", "invisible", "overflow-auto", "overflow-hidden", "overflow-scroll", "overflow-visible", "pe-auto", "pe-none", "shadow", "shadow-lg", "shadow-none", "shadow-sm", "sr-only", "sr-only-focusable", "visible", "visually-hidden", "visually-hidden-focusable", "modal", "modal-dialog-centered", "modal-lg", "modal-sm", "modal-xl", "modal-body", "modal-contant", "modal-dialog", "modal-dialog-scrollable", "modal-footer", "modal-fullscreen", "modal-fullscreen-lg-down", "modal-fullscreen-md-down", "modal-fullscreen-sm-down", "modal-fullscreen-xl-down", "modal-fullscreen-xxl-down", "modal-header", "modal-static", "modal-title", "collapse", "nav-item", "nav-link", "navbar", "navbar-brand", "navbar-collapse", "navbar-dark", "navbar-dark", "navbar-expand-*", "navbar-expand-lg", "navbar-expand-md", "navbar-expand-sm", "navbar-expand-xl", "navbar-expand-xxl", "navbar-light", "navbar-nav", "navbar-text", "navbar-toggler", "navbar-toggler-icon", "nav", "nav-fill", "nav-justified", "nav-pills", "nav-pills", "nav-tabs", "nav-tabs", "nav.nav", "tab-content", "tab-pane", "ul.nav", "page-item", "page-item", "pagination", "pagination-lg", "pagination-sm", "dismissible", "popovers", "align-*", "bottom-0", "bottom-100", "bottom-50", "clearfix", "end-0", "end-100", "end-50", "fixed-bottom", "fixed-top", "float-*-left", "float-*-none", "float-*-right", "float-end", "float-lg-end", "float-lg-none", "float-lg-start", "float-md-end", "float-md-none", "float-md-start", "float-none", "float-sm-end", "float-sm-none", "float-sm-start", "float-start", "float-xl-end", "float-xl-none", "float-xl-start", "float-xxl-end", "float-xxl-none", "float-xxl-start", "position-absolute", "position-relative", "position-static", "start-0", "start-100", "start-50", "sticky-lg-top", "sticky-md-top", "sticky-sm-top", "sticky-top", "sticky-xl-top", "top-0", "top-100", "top-50", "translate-middle", "multiple", "progress", "progress-bar", "progress-bar-animated", "progress-bar-striped", "data-spy", "h-100", "h-25", "h-50", "h-75", "h-auto", "mh-100", "min-vw-100", "mw-100", "w-100", "w-100", "w-25", "w-50", "w-75", "w-auto"]

class BootstrapCompletions(sublime_plugin.EventListener):
    def __init__(self):
        self.class_completions = [("%s \tBootstrap 5 Class" % s, s) for s in bootstrap_classes]

    def on_query_completions(self, view, prefix, locations):
        if view.match_selector(locations[0], "text.html string.quoted source.js"):
            return self.get_completions(view, prefix, locations)
        else:
            return []

    def get_completions(self, view, prefix, locations):
        LIMIT = 250
        cursor = locations[0] - len(prefix) - 1
        start = max(0, cursor - LIMIT - len(prefix))
        line = view.substr(sublime.Region(start, cursor))
        parts = line.split('=')
        if len(parts) > 1 and (parts[-2].strip().endswith("class") or parts[-2].strip().endswith("className")):
            if "={`" in line or '="' in line or "='" in line:
                return self.class_completions
            else:
                return []
        else:
            return []
